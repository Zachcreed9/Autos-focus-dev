(function (global, factory) {
  // Détection de l'environnement (CommonJS, AMD ou global)
  if (typeof exports === "object" && typeof module !== "undefined") {
    module.exports = factory();
  } else if (typeof define === "function" && define.amd) {
    define(factory);
  } else {
    (global = typeof globalThis !== "undefined" ? globalThis : global || self).Chart = factory();
  }
})(this, function () {
  "use strict";

  /**
   * Configuration par défaut pour les graphiques.
   * @returns {Object} Les options par défaut.
   */
  function getDefaultConfig() {
    return {
      datasets: {
        type: true,
        visible: true,
        backgroundColor: true,
      },
      elements: {
        visible: true,
      },
      plugins: {
        legend: {
          display: true,
          position: "top",
          align: "center",
        },
        title: {
          display: true,
          position: "top",
          align: "center",
        },
        tooltip: {
          display: true,
          mode: "nearest",
          intersect: true,
        },
      },
    };
  }

  // Types de graphiques disponibles
  const chartTypes = {
    bar: "bar",
    line: "line",
    pie: "pie",
    doughnut: "doughnut",
    radar: "radar",
    bubble: "bubble",
    scatter: "scatter",
    polarArea: "polarArea",
  };

  /**
   * Classe de base pour les graphiques.
   */
  class ChartBase {
    constructor(type, data) {
      this.type = type;
      this.data = data;
      this.options = {};
    }

    // Méthode pour mettre à jour le graphique
    update() {
      console.log("Mise à jour du graphique...");
    }

    // Méthode pour effacer le graphique
    clear() {
      console.log("Effacement du graphique...");
    }

    // Méthode pour détruire le graphique
    destroy() {
      console.log("Destruction du graphique...");
    }

    // Méthode pour exporter le graphique en image Base64
    toBase64Image() {
      return "data:image/png;base64,iVBORw0KKGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=";
    }
  }

  /**
   * Classe principale pour créer des graphiques.
   */
  class Chart extends ChartBase {
    constructor(type, data, options) {
      const mergedOptions = Object.assign({}, getDefaultConfig(), options);
      super(chartTypes[type] || "bar", data);
      this.options = mergedOptions;
    }
  }

  // Fonction principale pour créer un graphique
  return function createChart(type, data = {}, options = {}) {
    return new Chart(type, data, options);
  };
});
